{"version":3,"sources":["webpack:///./src/views/categoryPage/Snack.vue?49b6","webpack:///./src/views/categoryPage/Snack.vue","webpack:///./src/views/categoryPage/Snack.vue?0e65"],"names":["class","_createElementVNode","_createElementBlock","_Fragment","_renderList","$setup","item","index","key","productId","_createVNode","_component_van_card","price","productPrice","desc","productInfo","title","productTitle","thumb","productImg","lazy-load","tags","_component_van_stepper","$event","theme","input-width","button-size","style","integer","min","max","long-press","num","_component_van_badge","content","show-zero","_component_van_button","round","color","size","onTouchstart","_hoisted_2","name","setup","$store","useStore","commit","dataList","computed","state","Snack","cartList","Cart","initVanStepperInput","initVanStepperInputValue","value","initVanBadge","initVanBadgeValue","addCart","id","addCartHook","some","productCount","onActivated","plusOrMinusProductId","PlusOrMinusProduct","snack","forEach","count","removeProductId","RemoveProductCategory","resetInputBefLeave","rememberScrollY","__exports__","render"],"mappings":"kHAAA,W,sKCCMA,MAAM,mB,uBAiCGC,eAAyB,KAAtBD,MAAM,aAAW,Y,iBAAK,O,8KAjCtCE,eAuCK,KAvCL,EAuCK,qBAtCHA,eAqCKC,OAAA,KAAAC,eArCuBC,YAAQ,SAAxBC,EAAMC,G,wBAAlBL,eAqCK,MArCkCM,IAAKF,EAAKG,WAAjD,CACEC,eAmCWC,EAAA,CAlCRC,MAAON,EAAKO,aACZC,KAAMR,EAAKS,YACXC,MAAOV,EAAKW,aACZC,MAAOZ,EAAKa,WACZC,aAAW,GALd,CAOaC,KAAI,gBACb,iBAUE,CAVFX,eAUEY,EAAA,C,WATSjB,sBAAmB,SAAYE,G,yCAA/BF,sBAAmB,SAAYE,GAAKgB,GAC7CC,MAAM,QACNC,cAAY,SACZC,cAAY,SACZC,MAAA,8BACAC,QAAA,GACAC,IAAI,IACJC,IAAI,OACHC,cAAY,GATf,iDAYSC,IAAG,gBACZ,iBAYY,CAZZtB,eAYYuB,EAAA,CAXTC,QAAS7B,eAAY,SAAYE,GAClCuB,IAAI,KACHK,aAAW,GAHd,C,wBAKE,iBAMC,CANDzB,eAMC0B,EAAA,CALCC,MAAA,GACAC,MAAM,UACNC,KAAK,OACJC,aAAU,mBAAEnC,UAAQC,EAAKG,aAJ5B,C,wBAKG,iBAAyB,CAAzBgC,EAAyB,M,KAL5B,2B,KALF,sB,KArBJ,4CADF,Q,oFAoDW,GACbC,KAAM,QACNC,MAFa,WAGX,IAAMC,EAASC,iBACfD,EAAOE,OAAO,sBACd,IAAIC,EAAWC,gBAAS,kBAAMJ,EAAOK,MAAMC,MAAMH,YAC7CI,EAAWH,gBAAS,kBAAMJ,EAAOK,MAAMG,KAAKD,YAE5CE,EAAsBC,eAAyBP,EAASQ,OACxDC,EAAeC,eAAkBV,EAASQ,OAPxC,SAmCSG,EAnCT,gGAmCN,WAAuBC,GAAvB,iFAEEC,eAAYD,EAAIZ,EAASQ,MAAOF,EAAqB,QAAST,GAE9DO,EAASI,MAAMM,MAAK,SAACvD,GAEjBA,EAAKG,YAAckD,GACnBrD,EAAKW,eAAiB8B,EAASQ,MAAMI,EAAK,GAAG1C,eAE7CuC,EAAa,UAAYG,EAAK,IAAMrD,EAAKwD,iBAT/C,2CAnCM,wBAoDN,OA3CAC,gBAAY,WAQV,IAAIC,EAAuBhB,gBACzB,kBAAMJ,EAAOK,MAAMgB,mBAAmBD,qBAAqBE,SAE7DF,EAAqBT,MAAMY,SAAQ,SAAC7D,GAClCkD,EAAa,UAAYlD,EAAKqD,GAAK,IAAMrD,EAAK8D,SAEhDxB,EAAOE,OAAO,kCAAmC,SAGjD,IAAIuB,EAAkBrB,gBACpB,kBAAMJ,EAAOK,MAAMqB,sBAAsBD,gBAAgBH,SAE3DG,EAAgBd,MAAMY,SAAQ,SAAC7D,GAC7BkD,EAAa,UAAYlD,EAAO,IAAM,KAExCsC,EAAOE,OAAO,qCAAsC,YAiBtDyB,eAAmBlB,GACnBmB,iBAEO,CACLzB,WACAM,sBACAG,eACAE,a,iCCzGN,MAAMe,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-0daf5059.22e5e0f1.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Snack.vue?vue&type=style&index=0&id=05d122e4&lang=less&scoped=true\"","<template>\n  <ul class=\"snack-container\">\n    <li v-for=\"(item, index) in dataList\" :key=\"item.productId\">\n      <van-card\n        :price=\"item.productPrice\"\n        :desc=\"item.productInfo\"\n        :title=\"item.productTitle\"\n        :thumb=\"item.productImg\"\n        :lazy-load=\"true\"\n      >\n        <template #tags>\n          <van-stepper\n            v-model=\"initVanStepperInput['input_' + index]\"\n            theme=\"round\"\n            input-width=\"1.5rem\"\n            button-size=\"0.7rem\"\n            style=\"margin: 0.4rem 0rem 0.8rem\"\n            integer\n            min=\"1\"\n            max=\"9999\"\n            :long-press=\"false\"\n          />\n        </template>\n        <template #num>\n          <van-badge\n            :content=\"initVanBadge['badge_' + index]\"\n            max=\"99\"\n            :show-zero=\"false\"\n          >\n            <van-button\n              round\n              color=\"#219142\"\n              size=\"mini\"\n              @touchstart=\"addCart(item.productId)\"\n              ><i class=\"icon-plus\"></i>购物车</van-button\n            >\n          </van-badge>\n        </template>\n      </van-card>\n    </li>\n  </ul>\n</template>\n\n<script>\nimport { useStore } from 'vuex';\nimport { computed, onActivated } from '@vue/runtime-core';\nimport {\n  resetInputBefLeave,\n  rememberScrollY,\n  initVanStepperInputValue,\n  initVanBadgeValue,\n  addCartHook\n} from '@/hook/hooks.js';\n\nexport default {\n  name: 'Snack',\n  setup() {\n    const $store = useStore();\n    $store.commit('Snack/initDataList');\n    let dataList = computed(() => $store.state.Snack.dataList);\n    let cartList = computed(() => $store.state.Cart.cartList);\n\n    let initVanStepperInput = initVanStepperInputValue(dataList.value); // 初始化 van-stepper-input-value\n    let initVanBadge = initVanBadgeValue(dataList.value); // 初始化 van-badge\n\n    onActivated(() => {\n      /*\n        一下方法去更新badge的值比较繁琐和笨拙，其实可以使用 watch 的方法去监听 badge 是否变化，\n        如果变化的话，就去更新 badge 的值，watch 方法简单的很且代码少，不需要利用vuex去传递值，\n        watch 方法当时在写的时候并没有第一时间想到，而是采用了传统的vuex传递值的，在页面激活时去更新 badge 的方法。\n        所以一下方法略显笨拙，sorry呀！！！！！！\n      */\n      // 在 vuex 里获取此分类里的哪个物品被添加了数量\n      let plusOrMinusProductId = computed(\n        () => $store.state.PlusOrMinusProduct.plusOrMinusProductId.snack\n      );\n      plusOrMinusProductId.value.forEach((item) => {\n        initVanBadge['badge_' + (item.id - 1)] = item.count; // 把购物车里添加的物品数量van-badge修改下\n      });\n      $store.commit('PlusOrMinusProduct/clearProduct', 'snack'); // 重置完后，清空vuex里数据\n\n      // 在 vuex 里获取此分类里的哪个物品被移除了购物车\n      let removeProductId = computed(\n        () => $store.state.RemoveProductCategory.removeProductId.snack\n      );\n      removeProductId.value.forEach((item) => {\n        initVanBadge['badge_' + (item - 1)] = 0; // 把购物车里移除的物品van-badge重置为0\n      });\n      $store.commit('RemoveProductCategory/clearProduct', 'snack'); // 重置完后，清空vuex里数据\n    });\n\n    async function addCart(id) {\n      // 每次添加到购物车前，查看当前物品是否已经添加过，如果为false，则没有添加过，需要将其productId推进productInCart记录下来，以便用页面在此激活时重制van-stepper-input为1\n      addCartHook(id, dataList.value, initVanStepperInput, 'snack', $store); // 添加购物车\n      // 每次添加后，查看购物车里此物品的添加数量，赋值给 van-badge\n      cartList.value.some((item) => {\n        if (\n          item.productId === id &&\n          item.productTitle === dataList.value[id - 1].productTitle\n        ) {\n          initVanBadge['badge_' + (id - 1)] = item.productCount;\n        }\n      });\n    }\n\n    resetInputBefLeave(initVanStepperInput); // 离开页面时，把所以 van-stepper-input 的值不是为 1 的，重置为 1\n    rememberScrollY(); // hook 记录离开时滚动条位置，激活页面时返回其位置\n\n    return {\n      dataList,\n      initVanStepperInput,\n      initVanBadge,\n      addCart\n    };\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n/deep/ .van-button__text {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0 0.8rem;\n  .icon-plus {\n    margin-right: 0.2rem;\n  }\n  .icon-plus:before {\n    content: '\\ea0a';\n  }\n}\n</style>\n","import { render } from \"./Snack.vue?vue&type=template&id=05d122e4&scoped=true\"\nimport script from \"./Snack.vue?vue&type=script&lang=js\"\nexport * from \"./Snack.vue?vue&type=script&lang=js\"\n\nimport \"./Snack.vue?vue&type=style&index=0&id=05d122e4&lang=less&scoped=true\"\n\nimport exportComponent from \"/Users/korinli/vs-workspace/项目练习/dingdong/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-05d122e4\"]])\n\nexport default __exports__"],"sourceRoot":""}