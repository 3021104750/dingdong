{"version":3,"sources":["webpack:///./src/views/main/CategoryPage.vue","webpack:///./src/views/main/CategoryPage.vue?dd34"],"names":["_createVNode","_component_van_tabs","active","$setup","$event","shrink","lazy-render","title-active-color","color","style","_createElementBlock","_Fragment","_renderList","item","_createBlock","_component_van_tab","key","categoryId","title","categoryName","to","categoryRouterPath","_component_router_view","Component","_KeepAlive","include","_resolveDynamicComponent","name","setup","categoryComponment","markRaw","categoryList","$route","useRoute","$router","useRouter","getQuery","computed","query","ref","value","lastQuery","onActivated","undefined","some","index","push","path","onBeforeRouteLeave","from","next","activeOldValue","watch","newValue","oldValue","oldQuery","detectBackOrForward","__exports__","render"],"mappings":"kTACEA,eAkBWC,EAAA,CAjBDC,OAAQC,S,iDAAAA,SAAMC,IACtBC,OAAA,GACAC,cAAA,GACAC,qBAAmB,UACnBC,MAAM,UACNC,MAAA,kDANF,C,wBASI,iBAA4B,qBAD9BC,eASUC,OAAA,KAAAC,eAROT,gBAAY,SAApBU,G,wBADTC,eASUC,EAAA,CAPPC,IAAKH,EAAKI,WACVC,MAAOL,EAAKM,aACZC,GAAE,C,KAAkBP,EAAKQ,mB,kBAAiDR,EAAKI,cAJlF,oC,KARF,cAoBAjB,eAIcsB,EAAA,M,wBAHZ,gBADqBC,EACrB,EADqBA,UACrB,MAD8B,mBAC9BT,eAEaU,OAAA,CAFAC,QAAStB,sBAAkB,mBACtCW,eAAuCY,eAAvBH,MADlB,uB,OADF,I,8DAaa,GACbI,KAAM,eACNC,MAFa,WAIX,IAAMC,EAAqBC,eAAQ,CACjC,YACA,OACA,OACA,OACA,UACA,cACA,QACA,aACA,aACA,QACA,UACA,UAIIC,EAAeD,eAAQ,CAC3B,CACET,mBAAoB,0BACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,qBACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,qBACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,qBACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,wBACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,4BACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,sBACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,2BACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,2BACpBJ,WAAY,EACZE,aAAc,MAEhB,CACEE,mBAAoB,sBACpBJ,WAAY,GACZE,aAAc,MAEhB,CACEE,mBAAoB,wBACpBJ,WAAY,GACZE,aAAc,MAEhB,CACEE,mBAAoB,sBACpBJ,WAAY,GACZE,aAAc,QAIZa,EAASC,iBACTC,EAAUC,iBACVC,EAAWC,gBAAS,kBAAML,EAAOM,SACjCpC,EAASqC,eAAIH,EAASI,MAAMvB,WAAa,GAE3CwB,EAAYF,eAAI,GACpBG,gBAAY,gBACwBC,IAA9BP,EAASI,MAAMvB,YAEjBf,EAAOsC,MAAQC,EAAUD,MAEzBT,EAAaa,MAAK,SAAC/B,EAAMgC,GACnBA,IAAU3C,EAAOsC,OACnBN,EAAQY,KAAK,CACXC,KAAMlC,EAAKQ,mBACXiB,MAAO,CAAErB,WAAYJ,EAAKI,kBAMhCf,EAAOsC,MAAQJ,EAASI,MAAMvB,WAAa,KAI/C+B,gBAAmB,SAAC5B,EAAI6B,EAAMC,GAC5BT,EAAUD,MAAQtC,EAAOsC,MACzBU,OAIF,IAAIC,EAAiBZ,eAAI,GAUzB,OATAa,gBAAMpB,GAAQ,SAACqB,EAAUC,GACvB,IAAIC,EAAWlB,gBAAS,kBAAMiB,EAAShB,SACvCa,EAAeX,MAAQe,EAASf,MAAMvB,WAAa,KAGrDuC,gBAAoB,WAClBtD,EAAOsC,MAAQW,EAAeX,SAGzB,CACLtC,SACA2B,qBACAE,kB,qBC5JN,MAAM0B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0b6e5d.d4bbab47.js","sourcesContent":["<template>\n  <van-tabs\n    v-model:active=\"active\"\n    shrink\n    lazy-render\n    title-active-color=\"#219142\"\n    color=\"#219142\"\n    style=\"z-index: 99; position: sticky; top: 4.24rem\"\n  >\n    <van-tab\n      v-for=\"item in categoryList\"\n      :key=\"item.categoryId\"\n      :title=\"item.categoryName\"\n      :to=\"{\n        path: item.categoryRouterPath,\n        query: { categoryId: item.categoryId }\n      }\"\n    >\n    </van-tab>\n  </van-tabs>\n  <!-- 路由view -->\n  <router-view v-slot=\"{ Component }\">\n    <keep-alive :include=\"categoryComponment\">\n      <component :is=\"Component\"></component>\n    </keep-alive>\n  </router-view>\n</template>\n\n<script>\nimport { markRaw, ref } from '@vue/reactivity';\nimport { onBeforeRouteLeave, useRoute, useRouter } from 'vue-router';\nimport { computed, onActivated, watch } from '@vue/runtime-core';\nimport { detectBackOrForward } from '@/api/plugins.js';\n\nexport default {\n  name: 'CategoryPage',\n  setup() {\n    // router-view keepAlive 的组件的名字\n    const categoryComponment = markRaw([\n      'Vagetable',\n      'Meat',\n      'Bean',\n      'Milk',\n      'Seafood',\n      'QuickFreeze',\n      'Fruit',\n      'Marinating',\n      'Condiments',\n      'Snack',\n      'Alcohol',\n      'Daily'\n    ]);\n\n    // 分类信息\n    const categoryList = markRaw([\n      {\n        categoryRouterPath: '/categoryPage/vagetable',\n        categoryId: 1,\n        categoryName: '蔬菜'\n      },\n      {\n        categoryRouterPath: '/categoryPage/meat',\n        categoryId: 2,\n        categoryName: '肉类'\n      },\n      {\n        categoryRouterPath: '/categoryPage/bean',\n        categoryId: 3,\n        categoryName: '豆制'\n      },\n      {\n        categoryRouterPath: '/categoryPage/milk',\n        categoryId: 4,\n        categoryName: '乳制'\n      },\n      {\n        categoryRouterPath: '/categoryPage/seafood',\n        categoryId: 5,\n        categoryName: '海鲜'\n      },\n      {\n        categoryRouterPath: '/categoryPage/quickfreeze',\n        categoryId: 6,\n        categoryName: '速冻'\n      },\n      {\n        categoryRouterPath: '/categoryPage/fruit',\n        categoryId: 7,\n        categoryName: '水果'\n      },\n      {\n        categoryRouterPath: '/categoryPage/marinating',\n        categoryId: 8,\n        categoryName: '卤制'\n      },\n      {\n        categoryRouterPath: '/categoryPage/condiments',\n        categoryId: 9,\n        categoryName: '调味'\n      },\n      {\n        categoryRouterPath: '/categoryPage/snack',\n        categoryId: 10,\n        categoryName: '零食'\n      },\n      {\n        categoryRouterPath: '/categoryPage/alcohol',\n        categoryId: 11,\n        categoryName: '酒类'\n      },\n      {\n        categoryRouterPath: '/categoryPage/daily',\n        categoryId: 12,\n        categoryName: '日用'\n      }\n    ]);\n\n    const $route = useRoute();\n    const $router = useRouter();\n    const getQuery = computed(() => $route.query); // 获取路由 query 值\n    const active = ref(getQuery.value.categoryId - 1); // van-tabs active 值，动态获取路由传过来的query值\n\n    let lastQuery = ref(0);\n    onActivated(() => {\n      if (getQuery.value.categoryId === undefined) {\n        // 如果 query 值为空的话, 也就是说不是通过路由路径切换到页面的话，就获取上一次离开页面时保存的 active 值\n        active.value = lastQuery.value;\n        // 遍历查询与 active 值相同的 index，获取其页面的路由路径，再跳转路径\n        categoryList.some((item, index) => {\n          if (index === active.value) {\n            $router.push({\n              path: item.categoryRouterPath,\n              query: { categoryId: item.categoryId }\n            });\n          }\n        });\n      } else {\n        // 如果 query 里有值的话，就直接用其 query 值，使 active 值更新\n        active.value = getQuery.value.categoryId - 1;\n      }\n    });\n\n    onBeforeRouteLeave((to, from, next) => {\n      lastQuery.value = active.value; // 离开时 记录下当前激活的页面 actve 值\n      next();\n    });\n\n    // 监听路由变化，记录下上次路由页面的 query，获取 categoryId，查看是哪个category\n    let activeOldValue = ref(0);\n    watch($route, (newValue, oldValue) => {\n      let oldQuery = computed(() => oldValue.query);\n      activeOldValue.value = oldQuery.value.categoryId - 1;\n    });\n    // 监听用户是否点击了后退或者前进按钮\n    detectBackOrForward(function () {\n      active.value = activeOldValue.value; // 把前些贮存的旧的 category 值赋值给 active\n    });\n\n    return {\n      active,\n      categoryComponment,\n      categoryList\n    };\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n</style>\n","import { render } from \"./CategoryPage.vue?vue&type=template&id=4bb23a5c\"\nimport script from \"./CategoryPage.vue?vue&type=script&lang=js\"\nexport * from \"./CategoryPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/korinli/vs-workspace/项目练习/dingdong/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}